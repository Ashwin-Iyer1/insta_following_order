(()=>{(async()=>{let n=("; "+document.cookie).split("; ds_user_id=").length===2?("; "+document.cookie).split("; ds_user_id=").pop().split(";").shift():null;if(!n)throw new Error("Not logged in \u2014 ds_user_id cookie not found");let c=e=>new Promise(l=>setTimeout(l,e)),i=n;console.log(`User ID: ${i}`);let f="d04b0a864b4b54837c0d870b0e77e076",o=[],d=!0,t=null;for(;d;){let e={id:i,include_reel:!0,fetch_mutual:!0,first:50};t&&(e.after=t);let l=`https://www.instagram.com/graphql/query/?query_hash=${f}&variables=${encodeURIComponent(JSON.stringify(e))}`;await c(2e3+Math.random()*3e3);let a=await fetch(l,{credentials:"include"});if(!a.ok){console.error(`Request failed: ${a.status}`);break}let r=(await a.json()).data.user.edge_follow;for(let u of r.edges)o.push({username:u.node.username,full_name:u.node.full_name||""});d=r.page_info.has_next_page,t=r.page_info.end_cursor,console.log(`  Fetched ${o.length} so far ...`)}console.log(`
Total following: ${o.length}
`),console.log(`Most recently followed \u2192 oldest:
`),console.table(o.map((e,l)=>({"#":l+1,username:`@${e.username}`,full_name:e.full_name})));let g=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),s=document.createElement("a");s.href=URL.createObjectURL(g),s.download=`${n}_following.json`,s.click(),console.log(`
\u2713 Downloaded ${n}_following.json`)})();})();
